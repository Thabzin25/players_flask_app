<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generate Reports - Scout Dashboard</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
:root {
  --primary: #1a73e8;
  --primary-light: #e8f0fe;
  --secondary: #4285f4;
  --accent: #34a853;
  --warning: #fbbc05;
  --danger: #ea4335;
  --dark: #202124;
  --light: #f8f9fa;
  --gray: #5f6368;
  --border: #dadce0;
}
body { background: var(--light); color: var(--dark); font-family: 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif; margin:0; padding:0; min-height:100vh; }
/* Sidebar */
.sidebar { width:260px; background: linear-gradient(180deg, var(--primary) 0%, var(--secondary) 100%); color:white; position:fixed; top:0; left:0; height:100vh; box-shadow:0 0 15px rgba(0,0,0,0.08); z-index:100; transition:width 0.3s; }
.sidebar .logo { display:flex; align-items:center; padding:24px 20px; font-size:22px; font-weight:700; border-bottom:1px solid rgba(255,255,255,0.1); }
.sidebar .logo i { margin-right:12px; font-size:24px; cursor:pointer; }
.sidebar ul { list-style:none; padding:0; margin:0; }
.sidebar ul li { padding:14px 24px; display:flex; align-items:center; cursor:pointer; transition:background 0.2s; position:relative; }
.sidebar ul li.active, .sidebar ul li:hover { background: rgba(255,255,255,0.12); }
.sidebar ul li a { color:white; text-decoration:none; display:flex; align-items:center; width:100%; font-size:16px; }
.sidebar ul li i { margin-right:16px; font-size:18px; width:24px; text-align:center; }
.sidebar ul li span { font-weight:500; }
/* Main Content */
.main { margin-left:260px; padding:0; min-height:100vh; background: var(--light); transition:margin-left 0.3s; }
.topbar { display:flex; justify-content:space-between; align-items:center; padding:22px 32px; background:white; border-bottom:1px solid var(--border); box-shadow:0 2px 8px rgba(0,0,0,0.04); }
.search-container input { padding:8px 16px; border-radius:8px; border:1px solid var(--border); font-size:16px; background: var(--primary-light); color: var(--dark); outline:none; }
.topbar-actions { display:flex; align-items:center; gap:18px; }
.icon-btn { background: var(--primary-light); border:none; border-radius:50%; width:38px; height:38px; display:flex; align-items:center; justify-content:center; color: var(--primary); font-size:18px; cursor:pointer; transition: background 0.2s; }
.icon-btn:hover { background: var(--primary); color:white; }
.notification { position:relative; font-size:20px; color: var(--primary); }
.notification .badge { position:absolute; top:-6px; right:-8px; background: var(--danger); color:white; border-radius:50%; font-size:12px; padding:2px 6px; font-weight:700; }
.profile-menu { display:flex; align-items:center; position:relative; cursor:pointer; gap:10px; }
.profile-pic { width:36px; height:36px; border-radius:50%; object-fit:cover; border:2px solid var(--primary); }
.profile-name { font-weight:600; color: var(--primary); }
.profile-menu .dropdown { display:none; position:absolute; top:48px; right:0; background:white; border-radius:10px; box-shadow:0 4px 16px rgba(0,0,0,0.08); min-width:180px; z-index:10; flex-direction:column; padding:10px 0; }
.profile-menu:hover .dropdown { display:flex; }
.profile-menu .dropdown a { color: var(--dark); text-decoration:none; padding:10px 18px; font-size:15px; display:flex; align-items:center; gap:10px; transition: background 0.2s; }
.profile-menu .dropdown a:hover { background: var(--primary-light); color: var(--primary); }
/* Content */
.content { padding:32px; }
.content h1 { font-size:28px; color: var(--primary); font-weight:700; margin-bottom:24px; }
/* Report Form */
.report-form-container { background:white; border-radius:12px; padding:24px; box-shadow:0 4px 16px rgba(0,0,0,0.05); margin-bottom:32px; }
.report-form-container h2 { font-size:20px; font-weight:600; margin-bottom:16px; color: var(--primary); }
.form-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:16px; }
.form-group label { display:block; font-weight:500; margin-bottom:6px; }
.form-control { width:100%; padding:10px 14px; border:1px solid var(--border); border-radius:6px; outline:none; font-size:15px; }
textarea.form-control { min-height:100px; resize:vertical; }
.form-actions { display:flex; justify-content:flex-end; gap:12px; margin-top:20px; }
.btn { padding:10px 20px; border:none; border-radius:6px; font-size:15px; font-weight:600; cursor:pointer; display:flex; align-items:center; justify-content:center; gap:6px; }
.btn-primary { background: var(--primary); color:white; }
.btn-primary:hover { background: var(--secondary); }
.btn-secondary { background: var(--primary-light); color: var(--primary); }
.btn-secondary:hover { background: var(--secondary); color:white; }
/* Table */
.reports-table { width:100%; border-collapse:collapse; background:white; border-radius:12px; overflow:hidden; box-shadow:0 4px 16px rgba(0,0,0,0.05); }
.reports-table th, .reports-table td { padding:14px 16px; text-align:left; border-bottom:1px solid var(--border); }
.reports-table th { background: var(--primary-light); color: var(--primary); font-weight:600; }
.action-btn { cursor:pointer; color: var(--primary); margin-right:8px; transition:color 0.2s; }
.action-btn:hover { color: var(--danger); }
</style>
</head>
<body>
  <!-- Sidebar -->
  <div class="sidebar">
    <div class="logo"><i class="fas fa-football"></i><span>Scout Dashboard</span></div>
    <ul>
      <li class="active"><a href="scout-GenerateReports.html"><i class="fas fa-file-alt"></i><span>Generate Reports</span></a></li>
      <li><a href="scout-Players.html"><i class="fas fa-users"></i><span>Players</span></a></li>
      <li><a href="scout-Analytics.html"><i class="fas fa-chart-bar"></i><span>Analytics</span></a></li>
      <li><a href="scout-Settings.html"><i class="fas fa-cogs"></i><span>Settings</span></a></li>
    </ul>
  </div>
  <!-- Main -->
  <div class="main">
    <div class="topbar">
      <div class="search-container"><input type="text" placeholder="Search..."></div>
      <div class="topbar-actions">
        <div class="notification"><i class="fas fa-bell icon-btn"></i><span class="badge" id="notifCount">0</span></div>
        <div class="profile-menu">
          <img src="https://via.placeholder.com/36" class="profile-pic">
          <span class="profile-name">Admin</span>
          <div class="dropdown">
            <a href="#"><i class="fas fa-user"></i>Profile</a>
            <a href="#"><i class="fas fa-cog"></i>Settings</a>
            <a href="#"><i class="fas fa-sign-out-alt"></i>Logout</a>
          </div>
        </div>
      </div>
    </div>
    <div class="content">
      <h1>Generate Reports</h1>
      <div class="report-form-container">
        <h2>New Report</h2>
        <form id="reportForm">
          <div class="form-grid">
            <div class="form-group"><label>Player Name</label><input type="text" id="playerName" class="form-control" required></div>
            <div class="form-group"><label>Age</label><input type="number" id="playerAge" class="form-control" required></div>
            <div class="form-group"><label>Position</label><input type="text" id="position" class="form-control" required></div>
            <div class="form-group"><label>Club</label><input type="text" id="club" class="form-control" required></div>
            <div class="form-group" style="grid-column:1/-1;"><label>Report Details</label><textarea id="reportDetails" class="form-control" required></textarea></div>
          </div>
          <div class="form-actions">
            <button type="reset" class="btn btn-secondary"><i class="fas fa-undo"></i>Reset</button>
            <button type="submit" class="btn btn-primary"><i class="fas fa-paper-plane"></i>Submit</button>
          </div>
        </form>
      </div>
      <div class="report-list-container">
        <table class="reports-table">
          <thead>
            <tr><th>Player</th><th>Age</th><th>Position</th><th>Club</th><th>Details</th><th>Actions</th></tr>
          </thead>
          <tbody id="reportsTableBody"></tbody>
        </table>
      </div>
    </div>
  </div>
<script>
const backendUrl = "https://players-flask-app.onrender.com";

// Fetch reports on load
async function loadReports() {
  try {
    const res = await fetch(`${backendUrl}/reports`);
    const data = await res.json();
    const tbody = document.getElementById('reportsTableBody');
    tbody.innerHTML = '';
    data.forEach(r => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${r.playerName}</td>
        <td>${r.playerAge}</td>
        <td>${r.position}</td>
        <td>${r.club}</td>
        <td>${r.reportDetails}</td>
        <td>
          <i class="fas fa-file-pdf action-btn" title="Download PDF" onclick="downloadPDFReport(${JSON.stringify(r).replace(/"/g, '&quot;')})"></i>
          <i class="fas fa-print action-btn" title="Print Report" onclick="printReport(${JSON.stringify(r).replace(/"/g, '&quot;')})"></i>
          <i class="fas fa-trash action-btn" onclick="deleteReport('${r._id}', this)"></i>
        </td>`;
      tbody.appendChild(tr);
    });
  } catch(e){ console.error(e); }
}

// PDF generation
function downloadPDFReport(report) {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  doc.setFontSize(16);
  doc.text("Player Report", 10, 15);
  doc.setFontSize(12);
  doc.text(`Player Name: ${report.playerName}`, 10, 30);
  doc.text(`Age: ${report.playerAge}`, 10, 40);
  doc.text(`Position: ${report.position}`, 10, 50);
  doc.text(`Club: ${report.club}`, 10, 60);
  doc.text("Report Details:", 10, 70);
  doc.text(report.reportDetails, 10, 80, { maxWidth: 180 });
  doc.save(`${report.playerName}_Report.pdf`);
}

// Print report
function printReport(report) {
  const printWindow = window.open('', '', 'width=800,height=600');
  printWindow.document.write(`
    <html>
      <head>
        <title>Print Player Report</title>
        <style>
          body { font-family: 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif; padding: 32px; }
          h2 { color: #1a73e8; }
          .label { font-weight: bold; }
          .section { margin-bottom: 16px; }
        </style>
      </head>
      <body>
        <h2>Player Report</h2>
        <div class="section"><span class="label">Player Name:</span> ${report.playerName}</div>
        <div class="section"><span class="label">Age:</span> ${report.playerAge}</div>
        <div class="section"><span class="label">Position:</span> ${report.position}</div>
        <div class="section"><span class="label">Club:</span> ${report.club}</div>
        <div class="section"><span class="label">Report Details:</span><br>${report.reportDetails}</div>
        <script>
          window.onload = function() { window.print(); }
        <\/script>
      </body>
    </html>
  `);
  printWindow.document.close();
}

// Submit report
document.getElementById('reportForm').addEventListener('submit', async e=>{
  e.preventDefault();
  const payload = {
    playerName: document.getElementById('playerName').value,
    playerAge: document.getElementById('playerAge').value,
    position: document.getElementById('position').value,
    club: document.getElementById('club').value,
    reportDetails: document.getElementById('reportDetails').value
  };
  try {
    await fetch(`${backendUrl}/reports`, {
      method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(payload)
    });
    loadReports();
    e.target.reset();
  } catch(e){ console.error(e); }
});

// Delete report
async function deleteReport(id, el){
  try{
    await fetch(`${backendUrl}/reports/${id}`, { method:'DELETE' });
    el.closest('tr').remove();
  }catch(e){ console.error(e); }
}

loadReports();
</script>
</body>
</html>
